# imandra-language-server

A language server for imandra and imandra-reason

## Overview

example cmdline for testing ocamlmerlin on `/usr/local/var/imandra` switch:

``` opam exec --switch /usr/local/var/imandra -- ocamlmerlin server type-enclosing -position "12:36" -addsuffix .iml,.imli -addsuffix .ire,.irei -open Imandra_prelude -assocsuffix .iml:imandra -package imandra-prelude -package zarith -filename $(echo `pwd`/src-model/src-types/model_messages.iml) -dot-merlin $(`pwd`/src-model/src-types/) < src-model/src-types/model_messages.iml```

##

To test connectivity of the imandra-vscode-server part - run for example

```
nc -l -p 49570
```
in one window and then
```
imandra-vscode-server -d 4 --host 127.0.0.1 --port 49570
```
in another....

## testing

-Â Clone https://github.com/AestheticIntegration/imandra-vscode and run npm install; npm run build
- Clone https://github.com/AestheticIntegration/imandra-language-server and run npm install; npm run build
- In the terminal, go to the imandra-language-server folder and type npm link
- In the terminal, go to the imandra-vscode folder and type npm link imandra-language-server. This should make the version of imandra-language-server in imandra-vscode/node_modules point to your local version
- Open both imandra-vscode and imandra-language-server folders in VSCode (you can open a new VSCode window using cmd+shift+n on MacOS or ctrl-shift-n in Windows and Linux)
- In the imandra-vscode window, go to "Debug->Start Debugging". This will open a new VSCode window where the imandra-vscode extension has been replaced with the development one.
- In imandra-language-server window, go to the Debug panel (cmd-shift-d / ctrl-shift-d) and press the Play button at the top: "Attach to process"
- At this point, if you want to test for changes, you can run npm run watch in the "Terminal" panel of the imandra-language-server window, and restart the debugging process in the imandra-vscode window to test them.
